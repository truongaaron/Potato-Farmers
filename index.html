<!DOCTYPE html>
<head>
	<title> Potato Farmer </title>
	<style>
		body {
			overflow: hidden;
		}

		#potato {
		  position: absolute;
		  bottom: 31%;
		  z-index: 2;
		}

		#container {  
		  position: absolute;
		  bottom: -10px;
		  left: 0px;
		  width: 100%;
		  z-index: 1;
		}

		#guy {
		  position: absolute;
		  left: 700px;
		  bottom: 31%;
		  z-index: 3;
		}

		#background {
			position: absolute;
			top: 0;
			left: 0;
			width: 1600px;
			height: 900px;
			z-index: -1;
		}

		#potato-count {
			position: absolute;
			left: 45%;
			top: 40%;
		}

	</style>
</head>

<body> 
	<div><h2 id="potato-count"> Potatoes: </h2></div>

	<div id="container">
		<div id="guy">
			<img id="idle" src="https://drive.google.com/uc?export=download&id=1yRB3nDASmnmS9tH8w2WBq4ebK4cpo9Js"/>
		</div>
			<img id="floor" src="https://drive.google.com/uc?export=download&id=13YqSII2xgH6Sfqg0HxeH1IVybH1BMuIb"/>

		<div id="potato">
			<img src="https://drive.google.com/uc?export=download&id=1XZOx4XWZ248kgtiolhdxPlMU8NTRuWbf"/>
		</div>
	</div>

	<div>
		<img id="background" src="https://drive.google.com/uc?export=download&id=15TMaeBr9qk9FV1x_kzenOXuT5OXHquzQ"/> 
	</div>

	<script>
		/*
		platform: https://drive.google.com/uc?export=download&id=13YqSII2xgH6Sfqg0HxeH1IVybH1BMuIb
		idle-right: https://drive.google.com/uc?export=download&id=1q0lP-4RUcd3rvM1DKSjTXxbaz3MNwzJJ
		idle-left: https://drive.google.com/uc?export=download&id=1yRB3nDASmnmS9tH8w2WBq4ebK4cpo9Js
		attack-right: https://drive.google.com/uc?export=download&id=1ig2iROJWOqvdP7oCcgdnQHhUkZyzgLOi
		attack-left: https://drive.google.com/uc?export=download&id=1-GQu_YAbvoo2nuXC6l4ce5u7QuWuC0t6
		run-right: https://drive.google.com/uc?export=download&id=1biXVJA9_lI4es9i4wE497BKGjN1j98wY
		run-left: https://drive.google.com/uc?export=download&id=1GAJyfg_NRuEDaE61H4x5jTesNsKdduCq
		potato: https://drive.google.com/uc?export=download&id=1XZOx4XWZ248kgtiolhdxPlMU8NTRuWbf
		background: https://drive.google.com/uc?export=download&id=1MFI6T0rMaDL8YpdPdC59MzjZYFMuvrUz
		*/
		var runRight = 'https://drive.google.com/uc?export=download&id=1biXVJA9_lI4es9i4wE497BKGjN1j98wY';
		var runLeft = 'https://drive.google.com/uc?export=download&id=1GAJyfg_NRuEDaE61H4x5jTesNsKdduCq';
		var idleRight = 'https://drive.google.com/uc?export=download&id=1q0lP-4RUcd3rvM1DKSjTXxbaz3MNwzJJ';
		var idleLeft = 'https://drive.google.com/uc?export=download&id=1yRB3nDASmnmS9tH8w2WBq4ebK4cpo9Js';
		var attackRight = 'https://drive.google.com/uc?export=download&id=1ig2iROJWOqvdP7oCcgdnQHhUkZyzgLOi';
		var attackLeft = 'https://drive.google.com/uc?export=download&id=1-GQu_YAbvoo2nuXC6l4ce5u7QuWuC0t6';

		var keyState = {};
		window.addEventListener('keydown', function(e){
			keyState[e.keyCode || e.which] = true;
		},true);
		window.addEventListener('keyup', function(e){
			keyState[e.keyCode || e.which] = false;
		},true);

		var pressed = {};
		var output = document.getElementById('output');

		window.onkeydown = function(e) {
		    if ( pressed[e.which] ) return;
		    pressed[e.which] = e.timeStamp;
		};
		    
		window.onkeyup = function(e) {
		    if ( !pressed[e.which] ) return;
		    var duration = ( e.timeStamp - pressed[e.which] ) / 1000;
			//output.innerHTML += '<p>Key ' + e.which  + ' was pressed for ' + duration + ' seconds</p>';
		    pressed[e.which] = 0;


		    if(guyLeft-30 <= 40 && facing == 1 && e.which == 32 && duration >= .577){
		    	count += parseInt(duration/1);
		    	detectIfHit();
		    }
		 }

		var guy = document.getElementById('guy');
		var container = document.getElementById('container');

		var guyLeft = 700;

		// value: 0 = char facing right | value: 1 = char facing left
		var facing = 0;

		var bool = true;

		function initialize(){
			
		}

		function anim(){
		  if(keyState[39]){
		  	while(bool == true){
		    	document.getElementById("idle").src=runRight;
		    	bool = false;
			}
		    facing = 0;
		    guyLeft += 4;
		    guy.style.left = guyLeft + 'px';
		      if(guyLeft >= 1500) {
		        guyLeft -= 4;
		      } 
		  	  document.onkeyup = function() {setIdleRight()};
		  }

		  if(keyState[37]){
		  	while(bool == true){
		   		document.getElementById("idle").src=runLeft;
		   		bool = false;
		   	}
		    facing = 1;
		    guyLeft -= 4;
		    guy.style.left = guyLeft + 'px';
		      if(guyLeft <= 30) {
		        guyLeft += 4;
		      }
		      document.onkeyup = function() {setIdleLeft()};
		  }

		  if(keyState[32] && facing == 0){
			while(bool == true){
		   		document.getElementById("idle").src='https://drive.google.com/uc?export=download&id=1ig2iROJWOqvdP7oCcgdnQHhUkZyzgLOi';
		   		bool = false;
		   	}	
		   		document.onkeyup = function() {setIdleRight()};
		  } else if(keyState[32] && facing == 1){
		  		while(bool == true){
		   		document.getElementById("idle").src='https://drive.google.com/uc?export=download&id=1-GQu_YAbvoo2nuXC6l4ce5u7QuWuC0t6';
		   		bool = false;
		   	}	
		   		document.onkeyup = function() {setIdleLeft()};	   		
		  }
		}

		function setIdleRight(){
			document.getElementById("idle").src=idleRight;
			bool = true;
		}

		function setIdleLeft(){
		  	document.getElementById("idle").src=idleLeft;
		  	bool = true;
		}

		var div = document.getElementById('potato-count');
		var count = 0;
		div.innerHTML += count;
		function detectIfHit(){
	    	setIdleLeft();
			div.innerHTML = "Potatoes: " + count;
	    	console.log("hit");
		}    

		document.onkeydown = anim;
	
	</script>
</body>
